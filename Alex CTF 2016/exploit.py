import string
import sys
from subprocess import Popen, PIPE, STDOUT

cmd = "perf stat -x, -e instructions:u " + "/home/r00tus3r/Downloads/CTF\ Database/AlexCTF\ 2017/demove-re350\ /move.deob.out" + " 1>/dev/null"
key = ''
print cmd
while True:
    maximum = 0,0
    for i in string.printable:
        p = Popen(cmd, stdout=PIPE, stdin=PIPE, stderr=STDOUT, shell=True)
        stdout, _ = p.communicate(input=b'%s\n' % (key + i))
	stdout=stdout.split('\n')[1]
        nb_instructions = int(stdout.split(',')[0])
        if nb_instructions > maximum[0]:
            maximum = nb_instructions, i
    key += maximum[1]
    print key
    if maximum[1] == '}':
	break

